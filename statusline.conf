# Custom statusline configuration - replaces catppuccin theme
# Edit the color variables below to customize your tabs and status bar

# === Color Palette ===
# Background colors
thm_bg="#1f1f28"        # sumiInk1 - main background
thm_black="#16161d"     # sumiInk0 - darker background
thm_gray="#2a2a37"      # sumiInk4 - UI elements background
thm_black4="#54546d"    # sumiInk6 - darker UI elements

# Foreground colors
thm_fg="#dcd7ba"        # fujiWhite - main text
thm_cyan="#7aa89f"      # waveAqua2 - cyan accent
thm_blue="#7e9cd8"      # crystalBlue - blue accent
thm_magenta="#957fb8"   # oniViolet - purple accent
thm_pink="#d27e99"      # sakuraPink - pink accent
thm_red="#e82424"       # samuraiRed - red/error
thm_orange="#ffa066"    # surimiOrange - orange accent
thm_yellow="#e6c384"    # boatYellow2 - yellow accent
thm_green="#98bb6c"     # springGreen - green accent

# Background colors
color_bg=$thm_bg        # Main background
color_bg_dark="#181822"     # Darker backgrounds
color_bg_light="#24242e"    # Lighter backgrounds
# color_gray="#2A2A37"      # UI element backgrounds
color_gray=$thm_gray      # UI element backgrounds
color_black=$thm_black     # Darker backgrounds
color_dark_gray="#54546D" # Darker UI elements
color_light_gray="#787878"
color_white="#cccccc"
# color_soft_white="#CDD6F4"

# Foreground/text colors
color_fg=$thm_fg        # Main text

# Accent colors
color_orange="#FFA066"    # Active tab highlight
color_blue="#7E9CD8"      # Inactive tab highlight
color_cyan="#7AA89F"
color_magenta="#957FB8"
# color_pink=$thm_pink
color_pink="#d27e99"
# color_pink="#EEAAAA"
# color_red="#E82424"
color_red=$thm_red
# color_yellow="#E6C384"
color_yellow=$thm_yellow
color_green=$thm_green

# === General Window Settings ===
setw -g window-status-activity-style "fg=$color_fg,bg=$color_bg_dark,none"
setw -g window-status-separator ""
setw -g window-status-style "fg=$color_fg,bg=$color_bg_dark,none"

# === Status Bar Settings ===
set -g status "on"
set -g status-bg $color_bg_dark
set -g status-justify "left"
set -g status-left-length "100"
set -g status-right-length "10000"

# set-hook -g client-active 'set -g window-status-style "#{?client_prefix,#d27e99,#1F1F28}"'

# === Messages ===
set -g message-style "fg=$color_cyan,bg=$color_gray,align=centre"
set -g message-command-style "fg=$color_cyan,bg=$color_gray,align=centre"

# === Pane Borders ===
set -g pane-active-border-style "fg=$color_cyan,bg=$color_cyan"
set -g pane-border-style "fg=$color_dark_gray,bg=$color_bg_dark"
set -g pane-border-lines heavy
set -g window-style "fg=$color_light_gray,bg=$color_bg_dark"
set -g window-active-style "fg=$color_fg,bg=$color_bg"

# === Modes ===
setw -g clock-mode-colour "$color_cyan"
setw -g mode-style "fg=$color_bg_dark bg=$color_green bold"

# === Status Bar Content ===
# Left side: session name
set -g status-left "#[fg=#{?#{||:#{==:#{@current_display_mode},prefix},#{||:#{pane_in_mode},#{window_zoomed_flag}}},$color_bg,$color_light_gray},bg=#{?client_prefix,$color_pink,#{?pane_in_mode,$color_green,#{?window_zoomed_flag,$color_yellow,$color_bg_dark}}},nobold]#{?client_prefix,󰞦󰞦󰞦, #{?window_zoomed_flag,,󰞦} } #S  "

# Right side: directory, time
set -g status-right "#[fg=#{?client_prefix,$color_bg_dark,#{?pane_in_mode,$color_bg_dark,#{?window_zoomed_flag,$color_bg_dark,$color_light_gray}}},bg=#{?client_prefix,$color_pink,#{?pane_in_mode,$color_green,#{?window_zoomed_flag,$color_yellow,$color_bg_dark}}}]#{?window_zoomed_flag, #(~/.config/tmux/scripts/pane-icon.sh)  ,}#{b:pane_current_path}  󰃰  %I:%M  "

# === Tab Styling ===
# Active/current tab
setw -g window-status-current-format "#[fg=#{?client_prefix,$color_bg_dark,#{?@active_window_zoomed,$color_bg_dark,#{?@active_pane_in_mode,$color_bg_dark,$color_cyan}}},bg=#{?client_prefix,$color_pink,#{?@active_pane_in_mode,$color_green,#{?@active_window_zoomed,$color_yellow,$color_bg_dark}}},nobold,nounderscore,noitalics]#[fg=#{?#{@active_window_zoomed},$color_yellow,#{?client_prefix,$color_pink,#{?pane_in_mode,$color_green,#{?window_zoomed_flag,$color_yellow,$color_bg_dark}}}},bg=#{?#{||:#{@active_window_zoomed},#{||:#{@active_pane_in_mode},#{client_prefix}}},$color_bg_dark,$color_cyan}]#{?#{@active_window_zoomed}, , }#W #[fg=$color_bg_dark,bg=$color_orange]#[fg=#{?#{||:#{client_prefix},#{||:#{@active_pane_in_mode},#{@active_window_zoomed}}},$color_bg_dark,$color_cyan},bg=#{?client_prefix,$color_pink,#{?pane_in_mode,$color_green,#{?@active_window_zoomed,$color_yellow,default}}}] "

# Inactive tabs
setw -g window-status-format "#[fg=#{?#{||:#{client_prefix},#{||:#{@active_pane_in_mode},#{@active_window_zoomed}}},$color_bg_dark,$color_fg},bg=#{?client_prefix,$color_pink,#{?@active_pane_in_mode,$color_green,#{?@active_window_zoomed,$color_yellow,$color_bg_dark}}}] #W #{?client_prefix,#(~/.config/tmux/scripts/window-number.sh #I),#[fg=#{?pane_in_mode,$color_green,#{?window_zoomed_flag,$color_yellow,$color_fg}}]#{?#{||:#{pane_in_mode},#{window_zoomed_flag}},, }}#[fg=#{?pane_in_mode,#{?client_prefix,$color_pink,$color_green},$color_light_gray},bold,nounderscore,noitalics]  "


# Store colors for prefix highlighting
set -g @prefix_highlight_color $color_pink
set -g @prefix_normal_color $color_bg_dark
set -g @prefix_normal_pane_color $color_cyan
set -g @prefix_window_active_style_normal "fg=$color_fg,bg=$color_bg"
set -g @prefix_window_active_style_highlight "fg=$color_white,bg=$color_bg_light"

# Copy mode colors
set -g @copy_mode_color $color_green
set -g @copy_mode_pane_color $color_green
set -g @copy_mode_window_active_style "fg=$color_white,bg=$color_bg"

# Zoom mode colors
set -g @zoom_mode_color $color_yellow
set -g @zoom_mode_pane_color $color_yellow
set -g @zoom_mode_window_active_style "fg=$color_fg,bg=$color_bg"

# Highlight when any prefix command is about to run
bind -n C-Space run-shell "~/.config/tmux/scripts/prefix-highlight.sh activate"

# Synchronous hooks for instant visual feedback
set-hook -g pane-mode-changed 'run-shell "~/.config/tmux/scripts/prefix-highlight.sh"'
set-hook -g after-select-window 'run-shell "~/.config/tmux/scripts/prefix-highlight.sh"'
set-hook -g after-resize-pane 'if-shell "[ #{client_prefix} -eq 1 ] || [ #{pane_in_mode} -eq 1 ]" "run-shell -b \"~/.config/tmux/scripts/prefix-highlight.sh\""'

# Additional hooks to catch prefix-exit scenarios (synchronous for responsiveness)
set-hook -g after-split-window 'run-shell "~/.config/tmux/scripts/prefix-highlight.sh"'
set-hook -g after-new-window 'run-shell "~/.config/tmux/scripts/prefix-highlight.sh"'
set-hook -g after-kill-pane 'run-shell "~/.config/tmux/scripts/prefix-highlight.sh"'
set-hook -g client-session-changed 'run-shell "~/.config/tmux/scripts/prefix-highlight.sh"'
set-hook -g session-window-changed 'run-shell "~/.config/tmux/scripts/prefix-highlight.sh"'
