# Custom statusline configuration - replaces catppuccin theme
# Edit the color variables below to customize your tabs and status bar

# === Color Palette ===
# Background colors
thm_bg="#1f1f28"        # sumiInk1 - main background
thm_black="#16161d"     # sumiInk0 - darker background
thm_gray="#2a2a37"      # sumiInk4 - UI elements background
thm_black4="#54546d"    # sumiInk6 - darker UI elements

# Foreground colors
thm_fg="#dcd7ba"        # fujiWhite - main text
thm_cyan="#7aa89f"      # waveAqua2 - cyan accent
thm_blue="#7e9cd8"      # crystalBlue - blue accent
thm_magenta="#957fb8"   # oniViolet - purple accent
thm_pink="#d27e99"      # sakuraPink - pink accent
thm_red="#e82424"       # samuraiRed - red/error
thm_orange="#ffa066"    # surimiOrange - orange accent
thm_yellow="#e6c384"    # boatYellow2 - yellow accent
thm_green="#98bb6c"     # springGreen - green accent

# Background colors
color_bg=$thm_bg        # Main background
color_bg_dark="#181822"     # Darker backgrounds
color_bg_light="#24242e"    # Lighter backgrounds
color_gray=$thm_gray      # UI element backgrounds
color_black=$thm_black     # Darker backgrounds
color_dark_gray="#54546D" # Darker UI elements
color_light_gray="#787878"
color_white="#cccccc"
# color_soft_white="#CDD6F4"

# Foreground/text colors
color_fg=$thm_fg        # Main text

# Accent colors
color_orange="#FFA066"    # Active tab highlight
color_blue="#7E9CD8"      # Inactive tab highlight
color_cyan="#7AA89F"
color_magenta="#957FB8"
color_pink="#d27e99"
color_red=$thm_red
color_yellow=$thm_yellow
color_green=$thm_green

zoom_color=$color_yellow
copy_color=$color_green
prefix_color=$color_pink
active_color=$color_cyan
bg=$color_bg_dark
bg_focus=$color_bg
bg_active=$color_bg_light
fg=$color_fg
fg_active=$color_white
fg_focus=$color_white
neutral_visible=$color_light_gray
neutral_hidden=$color_dark_gray
window_tab_text=" #W "
status_left_text=" #S  #{?@active_window_zoomed,    ,}"
status_right_text="  󰃰  %I:%M  "
tab_start=""
tab_end=""

# === Border Style Configuration ===
# Character styles: 'single', 'double', 'heavy', etc.
# Extra bold (0/1): Whether to fill the border background with the pane color

# Non-active panes (always uses these settings regardless of mode)
set -g @normal_border_lines "single"
set -g @normal_extra_bold "0"

# Active pane when in normal state (no prefix/copy mode)
set -g @active_border_lines "heavy"
set -g @active_extra_bold "1"

# Active pane when in prefix mode
set -g @prefix_border_lines "heavy"
set -g @prefix_extra_bold "1"

# Active pane when in copy mode
set -g @copy_border_lines "heavy"
set -g @copy_extra_bold "1"

# Store colors for prefix highlighting
set -g @prefix_highlight_color $prefix_color
set -g @prefix_normal_color $bg
set -g @prefix_normal_pane_color $active_color
set -g @prefix_window_active_style_normal "fg=$fg,bg=$bg_focus"
set -g @prefix_window_active_style_highlight "fg=$fg_focus,bg=$bg_active"

# Copy mode colors
set -g @copy_mode_color $copy_color
set -g @copy_mode_pane_color $copy_color
set -g @copy_mode_window_active_style "fg=$fg_active,bg=$bg_focus"

# Zoom mode colors
set -g @zoom_mode_color $zoom_color
set -g @zoom_mode_pane_color $zoom_color
set -g @zoom_mode_window_active_style "fg=$fg,bg=$bg_focus"

# Normal (non-active) pane border color
set -g @normal_pane_border_color $color_dark_gray


# === General Window Settings ===
setw -g window-status-activity-style "fg=$fg,bg=$bg,none"
setw -g window-status-separator "   "
setw -g window-status-style "fg=$fg,bg=$bg,none"

# === Status Bar Settings ===
set -g status "on"
set -g status-bg $bg
set -g status-justify "centre"
set -g status-left-length "100"
set -g status-right-length "10000"

# set-hook -g client-active 'set -g window-status-style "#{?client_prefix,#d27e99,#1F1F28}"'

# === Messages ===
set -g message-style "fg=$bg_focus,bg=$active_color,align=centre"
set -g message-command-style "fg=$bg_focus,bg=$active_color,align=centre"

# === Pane Borders ===
set -g pane-active-border-style "fg=$active_color,bg=$active_color"
set -g pane-border-style "fg=$color_dark_gray,bg=$color_bg_dark"
set -g pane-border-lines heavy
set -g window-style "fg=$neutral_visible,bg=$color_bg_dark"
set -g window-active-style "fg=$fg,bg=$bg_focus"

# === Modes ===
setw -g clock-mode-colour "$color_cyan"
setw -g mode-style "fg=$color_bg_dark bg=$copy_color bold"

# === Status Bar Content ===
# Left side: session name
set -g status-left "#[fg=#{?#{||:#{==:#{@current_display_mode},prefix},#{||:#{pane_in_mode},#{window_zoomed_flag}}},$bg_focus,$neutral_visible},bg=#{?client_prefix,$prefix_color,#{?pane_in_mode,$copy_color,#{?window_zoomed_flag,$zoom_color,$bg}}},nobold]#{?client_prefix,󰞦󰞦󰞦, #{?window_zoomed_flag,,󰞦} }$status_left_text"

# Right side: directory, time
set -g status-right "#[fg=#{?client_prefix,$bg,#{?pane_in_mode,$bg,#{?window_zoomed_flag,$bg,$neutral_visible}}},bg=#{?client_prefix,$prefix_color,#{?pane_in_mode,$copy_color,#{?window_zoomed_flag,$zoom_color,$bg}}}]#{?window_zoomed_flag, #(~/.config/tmux/scripts/pane-icon.sh)  ,}#{b:pane_current_path}$status_right_text"

# === Tab Styling ===
# Active/current tab
setw -g window-status-current-format "#[fg=#{?client_prefix,$bg,#{?@active_window_zoomed,$bg,#{?@active_pane_in_mode,$bg,$color_cyan}}},bg=#{?client_prefix,$prefix_color,#{?@active_pane_in_mode,$copy_color,#{?@active_window_zoomed,$zoom_color,$bg}}},nobold,nounderscore,noitalics]$tab_start#[fg=#{?#{@active_window_zoomed},$zoom_color,#{?client_prefix,$prefix_color,#{?pane_in_mode,$copy_color,#{?window_zoomed_flag,$zoom_color,$bg}}}},bg=#{?#{||:#{@active_window_zoomed},#{||:#{@active_pane_in_mode},#{client_prefix}}},$bg,$color_cyan}]$window_tab_text#[fg=$bg,bg=$color_orange]#[fg=#{?#{||:#{client_prefix},#{||:#{@active_pane_in_mode},#{@active_window_zoomed}}},$bg,$color_cyan},bg=#{?client_prefix,$prefix_color,#{?pane_in_mode,$copy_color,#{?@active_window_zoomed,$zoom_color,default}}}]$tab_end"

# Inactive tabs

setw -g window-status-format "#[fg=#{?#{||:#{client_prefix},#{||:#{@active_pane_in_mode},#{@active_window_zoomed}}},$bg,#{?pane_in_mode,$copy_color,$fg}},bg=#{?client_prefix,$prefix_color,#{?@active_pane_in_mode,$copy_color,#{?@active_window_zoomed,$zoom_color,$bg}}}]$window_tab_text#[fg=#{?#{||:#{client_prefix},#{||:#{@active_window_zoomed},#{@active_pane_in_mode}}},$bg,#{?window_zoomed_flag,$zoom_color,$neutral_hidden}}]#{?client_prefix,#(~/.config/tmux/scripts/window-number.sh #I),#{?#{>:#{window_panes},1},#{?#{||:#pane_in_mode,#window_zoomed_flag},#(~/.config/tmux/scripts/pane-icon.sh #I),#{?#{||:#{pane_in_mode},#{window_zoomed_flag}},#[fg=#{?window_zoomed_flag,$zoom_color,$copy_color}]$tab_end, }}, }}"


# Highlight when any prefix command is about to run
bind -n C-Space run-shell "~/.config/tmux/scripts/prefix-highlight.sh activate"

# Synchronous hooks for instant visual feedback
set-hook -g pane-mode-changed 'run-shell "~/.config/tmux/scripts/prefix-highlight.sh"'
set-hook -g after-select-window 'run-shell "~/.config/tmux/scripts/prefix-highlight.sh"'
set-hook -g after-resize-pane 'if-shell "[ #{client_prefix} -eq 1 ] || [ #{pane_in_mode} -eq 1 ]" "run-shell -b \"~/.config/tmux/scripts/prefix-highlight.sh\""'

# Additional hooks to catch prefix-exit scenarios (synchronous for responsiveness)
set-hook -g after-split-window 'run-shell "~/.config/tmux/scripts/prefix-highlight.sh"'
set-hook -g after-new-window 'run-shell "~/.config/tmux/scripts/prefix-highlight.sh"'
set-hook -g after-kill-pane 'run-shell "~/.config/tmux/scripts/prefix-highlight.sh"'
set-hook -g client-session-changed 'run-shell "~/.config/tmux/scripts/prefix-highlight.sh"'
set-hook -g session-window-changed 'run-shell "~/.config/tmux/scripts/prefix-highlight.sh'
