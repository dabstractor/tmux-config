source-file ~/.config/tmux/tmux.reset.conf

# Set the default terminal to a modern, compatible type for Alacritty.
# Using "xterm-kitty" here was incorrect and likely the root cause of the issue.
set-option -g default-terminal "tmux-256color"
# set-option -g default-terminal "${TERM}" # This is incorrect, do not use.
set-option -sa terminal-overrides ",*:RGB"
set-option -g default-shell /usr/bin/zsh
set-option -g extended-keys on

# set -g prefix None
set -g prefix C-b

unbind C-Space

# bind-key -n C-Space run-shell "~/.config/tmux/scripts/prefix-highlight.sh on" \; switch-client -T prefix
set -g base-index 1              # start indexing windows at 1 instead of 0
set -g detach-on-destroy off     # don't exit from tmux when closing a session
set -g escape-time 0             # zero-out escape time delay
set -g history-limit 1000000     # increase history size (from 2,000)
set -g renumber-windows on       # renumber all windows when any window is closed
set -g set-clipboard on          # use system clipboard
set -g status-position top       # macOS / darwin style
setw -g mode-keys vi

# set -sg repeat-time 1000
# set -g mouse on                  # enable mouse support for wheel events (won't affect normal scrolling)

set -g @thumbs-key e
set -g @thumbs-unique enabled
set -g @thumbs-command 'echo -n {} | wl-copy'

# Keyboard bindings for pane navigation (preserves normal mouse scrolling)
bind-key -n C-M-h run-shell "~/.config/tmux/scripts/select-pane.sh -L"   # Ctrl+Alt+h -> pane left  
bind-key -n C-M-l run-shell "~/.config/tmux/scripts/select-pane.sh -R"   # Ctrl+Alt+l -> pane right
bind-key -n C-M-k run-shell "~/.config/tmux/scripts/select-pane.sh -U"   # Ctrl+Alt+k -> pane up
bind-key -n C-M-j run-shell "~/.config/tmux/scripts/select-pane.sh -D"   # Ctrl+Alt+j -> pane down

# Window management
bind-key W kill-window                                                    # <prefix>+Shift+W -> kill window
bind-key X kill-window                                                    # Alternative: <prefix>+Shift+X -> kill window (for testing)
bind-key Q kill-server
# Removed problematic bindings  
# Removed problematic bindings
# Removed problematic bindings
# Removed problematic bindings

set -g @fzf-url-fzf-options '-p 60%,30% --prompt="ï‚Ž   " --border-label=" Open URL "'
set -g @fzf-url-history-limit '2000'

# TPM Plugins - MUST be declared BEFORE running TPM
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'fcsonline/tmux-thumbs'
set -g @plugin 'sainnhe/tmux-fzf'
set -g @plugin 'wfxr/tmux-fzf-url'
set -g @plugin 'omerxx/tmux-sessionx'
set -g @plugin 'thesast/tmux-transient-status'

# Plugin configuration
set -g @sessionx-bind '^Space'
set -g @sessionx-window-height '85%'
set -g @sessionx-window-width '75%'
set -g @sessionx-zoxide-mode 'on'
set -g @sessionx-filter-current 'false'
set -g @sessionx-preview-enabled 'true'
set -g @continuum-restore 'on'
set -g @resurrect-strategy-nvim 'session'

# Load statusline configuration (sets @tubular_* options)
source-file ~/.config/tmux/tubular.conf

# Manual plugin loading (if needed for specific plugins)
run-shell '~/.config/tmux/plugins/tmux-thumbs/tmux-thumbs.tmux'

# Initialize TPM (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
